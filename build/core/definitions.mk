#
# Copyright (C) 2024 The LineageOS Project
#
# SPDX-License-Identifier: Apache-2.0
#

ifeq ($(USES_DEVICE_VIRT_VIRT_COMMON),true)

# Firmware mount point
FIRMWARE_MOUNT_POINT := $(TARGET_OUT_VENDOR)/firmware_mnt
ALL_DEFAULT_INSTALLED_MODULES += $(FIRMWARE_MOUNT_POINT)

# Partition images

##### EFI.img #####
ifneq ($(TARGET_BOOT_MANAGER),)
INSTALLED_ESPIMAGE_TARGET := $(PRODUCT_OUT)/EFI.img
INSTALLED_RADIOIMAGE_TARGET += $(INSTALLED_ESPIMAGE_TARGET)
endif # TARGET_BOOT_MANAGER

##### grub_boot.img #####
ifeq ($(AB_OTA_UPDATER),true)
ifeq ($(TARGET_BOOT_MANAGER),grub)
INSTALLED_GRUB_BOOT_IMAGE_TARGET := $(PRODUCT_OUT)/grub_boot.img
INSTALLED_RADIOIMAGE_TARGET += $(INSTALLED_GRUB_BOOT_IMAGE_TARGET)
endif # TARGET_BOOT_MANAGER
endif # AB_OTA_UPDATER

##### persist.img #####
INSTALLED_PERSISTIMAGE_TARGET := $(PRODUCT_OUT)/persist.img
INSTALLED_RADIOIMAGE_TARGET += $(INSTALLED_PERSISTIMAGE_TARGET)
INSTALLED_RECOVERY_PERSISTIMAGE_GZ_TARGET := $(PRODUCT_OUT)/recovery/root/system/etc/persist.img.gz
ALL_DEFAULT_INSTALLED_MODULES += $(INSTALLED_RECOVERY_PERSISTIMAGE_GZ_TARGET)

# Super image (empty)
INSTALLED_RECOVERY_SUPERIMAGE_EMPTY_RAW_TARGET := $(PRODUCT_OUT)/recovery/root/system/etc/super_empty_raw.img
ALL_DEFAULT_INSTALLED_MODULES += $(INSTALLED_RECOVERY_SUPERIMAGE_EMPTY_RAW_TARGET)

endif # USES_DEVICE_VIRT_VIRT_COMMON
